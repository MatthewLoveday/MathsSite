<% include ../partials/header %>

	<nav>
		<div class="nav-wrapper">
			<a href="/" class="brand-logo">-1^(1/2) 2^3 sigma pi</a>
			<ul id="nav-mobile" class="right hide-on-med-and-down">
				<li>
					<a href="/users/<%= user._id %>">
						<i class="material-icons left">dashboard</i>
						Home
					</a>
				</li>
				<li class="active">
					<a href="/users/<%= user._id %>/tests/new">
						<i class="material-icons left">assignment</i>
						Test
					</a>
				</li>
				<li>
					<a href="/logout">
						<i class="material-icons left">pause</i>
						Logout
					</a>
				</li>
			</ul>
		</div>
	</nav>

	



	<div class="container">
		<div class="row">
			<h1 class="col s6 offset-s3">New test page</h1>
		</div>
		<div class="row">
			<form action="/users/<%= user._id %>/tests" method="POST">
				<div class="row">
					<p class="range-field col s8"><input id="timeRange" type="range" min="4" max="180" required/></p>
					<div class="input-field col s4">
						<input id="time" class="validate" type="number" min="4" max="180" name="time" required>
						<label for="time" data-error="Time outside appropriate range">Time</label>
					</div>
				</div>
				<div class="row">
					<div class="input-field col s6">
						<select name="moduleName" id="modules" required>
							<option value="" disabled selected>Choose your module</option>
							<% for(var i=0;i<user.examBoard.modules.length;i++){ %>
								<option value="<%= user.examBoard.modules[i].name %>"><%= user.examBoard.modules[i].name %></option>
							<% } %>
						</select>
						<label>Module</label>
					</div>
					<div class="input-field col s6">
						<select multiple name="topics" id="topics" required>
							<option value="" disabled selected>Choose your topics</option>
						</select>
						<label>Topics</label>
					</div>
				</div>
				<div class="row">
					<button class="btn waves-effect waves-light" type="submit" name="action">Submit
						<i class="material-icons right">send</i>
					</button>
				</div>
			</form>
		</div>
		
	</div>

	<script>
		$(document).ready(function() {
			$("#modules").change(function(){
				var module = $("#modules").val();
				$("#topics").empty().append("<option value='' disabled selected>Choose your topics</option>");
				<% for(var i=0;i<user.examBoard.modules.length;i++){ %>
					if("<%= user.examBoard.modules[i].name %>" == module){
						<% for(var t=0;t<user.examBoard.modules[i].topics.length;t++){ %>
							$("#topics").append("<option value='<%= user.examBoard.modules[i].topics[t].name %>'><%= user.examBoard.modules[i].topics[t].name %></option>");
						<% } %>
					}
				<% } %>
				$('select').material_select();
			});
		});
	</script>


<% include ../partials/footer %>